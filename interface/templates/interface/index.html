{% load static %}

<html>

	<head>
		<title>Blockly PPR</title>
		<script>
			var allowDuplicates = true;
			var rootBlock;
		</script>
		<script src="{% static 'interface/blockly/appengine/storage.js' %}"></script>
		<script src="{% static 'interface/blockly/blockly_compressed.js' %}"></script>
		<script src="{% static 'interface/blockly/blocks_compressed.js' %}"></script>
		<script src="{% static 'interface/blockly/javascript_compressed.js' %}"></script>
		<script src="{% static 'interface/blockly/arduino_compressed.js' %}"></script>
		<script src="{% static 'interface/blockly/msg/js/en.js' %}"></script>
		<script src="{% static 'interface/download.js' %}"></script>
		<script src="{% static 'interface/comps.js' %}"></script>
		<script src="{% static 'interface/indextoolbox.js' %}"></script>
		<script src="{% static 'interface/save.js' %}"></script>
		<script src="{% static 'interface/indexcodegen.js' %}"></script>
		<link rel="stylesheet" type="text/css" href="{% static 'interface/styles.css' %}">
	</head>

	<body>
		<script>
			if ('BlocklyStorage' in window) {
				BlocklyStorage.HTTPREQUEST_ERROR = 'There was a problem with the request.\n';
				BlocklyStorage.LINK_ALERT = 'Share your blocks with this link:\n\n%1';
				BlocklyStorage.HASH_ERROR = 'Sorry, "%1" doesn\'t correspond with any saved Blockly file.';
				BlocklyStorage.XML_ERROR = 'Could not load your saved file.\n' +
					'Perhaps it was created with a different version of Blockly?';
			} else {
				document.write('<p id="sorry">Sorry, cloud storage is not available.  This demo must be hosted on App Engine.</p>');
			}
		</script>
		<script src="{% static 'interface/trial.js' %}"></script>

		<div class="toolbar" id="toolbar">
			<div class="title">
				Blockly Primitives
			</div>
			<div class="fill"></div>

			<a class="link" href="prevblocks/">
				Previously Created Blocks
			</a>


			<div class="dropdown">
				<div id="target" class="dropbtn">Target</div>
				<div class="dropdown-content">
					<button id="none" class="hide" onclick="targetNone()"></button>
					<label for="none" class="menuitem">
						None
					</label>

					<button id="ard" class="hide" onclick="targetArd()"></button>
					<label for="ard" class="menuitem">
						Arduino
					</label>

					<button id="rp" class="hide" onclick="targetRP()"></button>
					<label for="rp" class="menuitem">
						Raspberry Pi
					</label>
				</div>
			</div>


			<div class="dropdown">
				<div class="dropbtn">File</div>
				<div class="dropdown-content">
					<button id="save" class="hide" onclick="BlocklyStorage.link()"></button>
					<label for="save" class="menuitem">
						Save
					</label>

					<button class="hide" id="download" onclick="downloadBPSession()"></button>
					<label for="download" class="menuitem">
						Download Code
					</label>

					<input class="hide" type="file" id="input" onchange="uploadBPSession(this.files)">
					<label for="input" class="menuitem">
						Upload Code
					</label>

					<button class="hide" id="printCode" onclick="getCode()"></button>
					<label for="printCode" class="menuitem">
						Print Arduino Code
					</label>
				</div>
			</div>

		</div>
		<script src="{% static 'interface/target.js' %}"></script>
		<div id="blocklyDiv"></div>
		<div id="createdDiv" hidden="true"></div>
		<xml id="toolbox" style="display: none">
			<category name="Logic" colour="210">
				<block type="controls_if"></block>
				<block type="logic_compare"></block>
				<block type="logic_operation"></block>
				<block type="logic_negate"></block>
				<block type="logic_boolean"></block>
				<block type="logic_ternary"></block>
			</category>
			<category name="Loops" colour="120">
				<block type="controls_repeat_ext">
					<value name="TIMES">
						<shadow type="math_number">
							<field name="NUM">10</field>
						</shadow>
					</value>
				</block>
				<block type="controls_whileUntil"></block>
				<block type="controls_for">
					<value name="FROM">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="TO">
						<shadow type="math_number">
							<field name="NUM">10</field>
						</shadow>
					</value>
					<value name="BY">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
				</block>
				<block type="controls_flow_statements"></block>
			</category>
			<category name="Math" colour="230">
				<block type="math_number"></block>
				<block type="math_arithmetic">
					<value name="A">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="B">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
				</block>
				<block type="math_single">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">9</field>
						</shadow>
					</value>
				</block>
				<block type="math_trig">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">45</field>
						</shadow>
					</value>
				</block>
				<block type="math_constant"></block>
				<block type="math_number_property">
					<value name="NUMBER_TO_CHECK">
						<shadow type="math_number">
							<field name="NUM">0</field>
						</shadow>
					</value>
				</block>
				<block type="math_change">
					<value name="DELTA">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
				</block>
				<block type="math_round">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">3.1</field>
						</shadow>
					</value>
				</block>
				<block type="math_on_list"></block>
				<block type="math_modulo">
					<value name="DIVIDEND">
						<shadow type="math_number">
							<field name="NUM">64</field>
						</shadow>
					</value>
					<value name="DIVISOR">
						<shadow type="math_number">
							<field name="NUM">10</field>
						</shadow>
					</value>
				</block>
				<block type="math_constrain">
					<value name="VALUE">
						<shadow type="math_number">
							<field name="NUM">50</field>
						</shadow>
					</value>
					<value name="LOW">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="HIGH">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="math_random_int">
					<value name="FROM">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="TO">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="math_random_float"></block>
			</category>
			<category name="Text" colour="160">
				<block type="text"></block>
				<block type="text_join"></block>
				<block type="text_append">
					<value name="TEXT">
						<shadow type="text"></shadow>
					</value>
				</block>
				<block type="text_length">
					<value name="VALUE">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_isEmpty">
					<value name="VALUE">
						<shadow type="text">
							<field name="TEXT"></field>
						</shadow>
					</value>
				</block>
				<block type="text_indexOf">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">{textVariable}</field>
						</block>
					</value>
					<value name="FIND">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>

				<block type="text_charAt">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">{textVariable}</field>
						</block>
					</value>
				</block>
				<block type="text_getSubstring">
					<value name="STRING">
						<block type="variables_get">
							<field name="VAR">{textVariable}</field>
						</block>
					</value>
				</block>
				<block type="text_changeCase">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_trim">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_print">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_prompt_ext">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
			</category>
			<category name="Lists" colour="260">
				<block type="lists_create_with">
					<mutation items="0"></mutation>
				</block>
				<block type="lists_create_with"></block>
				<block type="lists_repeat">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">5</field>
						</shadow>
					</value>
				</block>
				<block type="lists_length"></block>
				<block type="lists_isEmpty"></block>
				<block type="lists_indexOf">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">{listVariable}</field>
						</block>
					</value>
				</block>
				<block type="lists_getIndex">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">{listVariable}</field>
						</block>
					</value>
				</block>
				<block type="lists_setIndex">
					<value name="LIST">
						<block type="variables_get">
							<field name="VAR">{listVariable}</field>
						</block>
					</value>
				</block>
				<block type="lists_getSublist">
					<value name="LIST">
						<block type="variables_get">
							<field name="VAR">{listVariable}</field>
						</block>
					</value>
				</block>
				<block type="lists_split">
					<value name="DELIM">
						<shadow type="text">
							<field name="TEXT">,</field>
						</shadow>
					</value>
				</block>
				<block type="lists_sort"></block>
			</category>
			<category name="Colour" colour="20">
				<block type="colour_picker"></block>
				<block type="colour_random"></block>
				<block type="colour_rgb">
					<value name="RED">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
					<value name="GREEN">
						<shadow type="math_number">
							<field name="NUM">50</field>
						</shadow>
					</value>
					<value name="BLUE">
						<shadow type="math_number">
							<field name="NUM">0</field>
						</shadow>
					</value>
				</block>
				<block type="colour_blend">
					<value name="COLOUR1">
						<shadow type="colour_picker">
							<field name="COLOUR">#ff0000</field>
						</shadow>
					</value>
					<value name="COLOUR2">
						<shadow type="colour_picker">
							<field name="COLOUR">#3333ff</field>
						</shadow>
					</value>
					<value name="RATIO">
						<shadow type="math_number">
							<field name="NUM">0.5</field>
						</shadow>
					</value>
				</block>
			</category>
			<sep></sep>
			<category name="Variables" colour="330" custom="VARIABLE"></category>
			<category name="Functions" colour="290" custom="PROCEDURE"></category>
		</xml>

		<xml id="startBlocks" style="display: none">
			<block type="component_create"></block>
		</xml>

		<script src="{% static 'interface/blocks.js' %}"></script>
		<script src="{% static 'interface/blockly/msg/js/en.js' %}"></script>
		<script>
			var workspace = Blockly.inject('blocklyDiv', {
				toolbox: Toolbox.xmlTree
			});

			// An href with #key trigers an AJAX call to retrieve saved blocks.
			if ('BlocklyStorage' in window && window.location.hash.length > 1) {
				BlocklyStorage.retrieveXml(window.location.hash.substring(1));
			}

			Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'), workspace);
		</script>
		<script src="{% static 'interface/indexevents.js' %}"></script>
	</body>

</html>
